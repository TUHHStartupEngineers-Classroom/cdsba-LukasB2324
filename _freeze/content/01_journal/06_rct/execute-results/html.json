{
  "hash": "bcc1853a8d446afd6c2589f11b3b0cf0",
  "result": {
    "markdown": "---\ntitle: \"Randomized Controlled Trials\"\n---\n\n\n# Load packages\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-1_72b4fe388a9e9a268514441046bcb5ae'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.4     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.1\n#> ✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.2     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(dagitty)\nlibrary(ggdag)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attache Paket: 'ggdag'\n#> \n#> Das folgende Objekt ist maskiert 'package:stats':\n#> \n#>     filter\n```\n:::\n:::\n\n\n# Load data\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-2_daa4e144a4bc6f9b619c801d4740efee'}\n\n```{.r .cell-code}\nsetwd(\"D:/CausalDataScience/cdsba-LukasB2324/content/01_journal\")\nabtest_data<-readRDS(\"Data/abtest_online.rds\")\n```\n:::\n\n\n\n# Assignment 1\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-3_bb338d51e854506b2d4dd0a93bd9e932'}\n\n```{.r .cell-code}\nabtest_data_mod<-abtest_data\nabtest_data_mod[\"mobile_device\"]<-abtest_data_mod[\"mobile_device\"]*1 # convert logical values to numeric vauels 0 and 1\nabtest_data_mod[\"chatbot\"]<-abtest_data_mod[\"chatbot\"]*1\nabtest_data_mod<-abtest_data_mod[,2:6]# exclude ip adress\n\ncompare_previousVisit <- \n  ggplot(abtest_data, \n         aes(x = chatbot, \n             y = previous_visit, \n             color = as.factor(chatbot))) +\n  stat_summary(geom = \"errorbar\", \n               width = .5,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = \"chatbot\", y = \"previous_visit\", title = \"Number of previous visits\")\n\ncompare_mobileDevice <- \n  ggplot(abtest_data_mod, \n         aes(x = chatbot, \n             y = mobile_device, \n             color = as.factor(chatbot))) +\n  stat_summary(geom = \"errorbar\", \n               width = .5,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = \"chatbot\", y = \"mobile_device\", title = \"Number of users of a mobile device\")\n\ncompare_purchase <- \n  ggplot(abtest_data, \n         aes(x = chatbot, \n             y = purchase, \n             color = as.factor(chatbot))) +\n  stat_summary(geom = \"errorbar\", \n               width = .5,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = \"chatbot\", y = \"purchase\", title = \"Number of customers who purchase\")\n\ncompare_purchase_amount <- \n  ggplot(abtest_data, \n         aes(x = chatbot, \n             y = purchase_amount, \n             color = as.factor(chatbot))) +\n  stat_summary(geom = \"errorbar\", \n               width = .5,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = \"chatbot\", y = \"purchase_amount\", title = \"Purchase amount\")\n\ncompare_previousVisit\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncompare_mobileDevice\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\ncompare_purchase\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\ncompare_purchase_amount\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n:::\n\nThe number of users of a mobile device is balanced between the two groups chatbot==TRUE and chatbot==FALSE. In terms of pervious_visits there is an overlap of the 95%-confidence intervals of the two groups, but they still show a noticable difference. The outcome purchase and purchase_amount show no overlap of the 95%-confidence intervals of the two groups.\n\n\n\n# Assignment 2\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-4_7ffae71919ae3c4786c47feaf4824e0f'}\n\n```{.r .cell-code}\nlm_2<-lm(purchase_amount~previous_visit+mobile_device+chatbot,abtest_data_mod)\nsummary(lm_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ previous_visit + mobile_device + \n#>     chatbot, data = abtest_data_mod)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -25.414 -14.428  -8.435  12.559  64.584 \n#> \n#> Coefficients:\n#>                Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)     15.2840     1.1227  13.614  < 2e-16 ***\n#> previous_visit   0.7792     0.2869   2.716  0.00673 ** \n#> mobile_device   -0.8562     1.2642  -0.677  0.49841    \n#> chatbot         -6.8488     1.1792  -5.808 8.49e-09 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.6 on 996 degrees of freedom\n#> Multiple R-squared:  0.04243,\tAdjusted R-squared:  0.03954 \n#> F-statistic: 14.71 on 3 and 996 DF,  p-value: 2.228e-09\n```\n:::\n:::\n\nThe chatbot interacting with the customer correlates negatively with the purchase_amount. The effect is highly significant.\n\n\n# Assignment 3\n## Include interaction for subgroup mobile users\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-5_652330b99d4bbf48a6c720107e37d6c7'}\n\n```{.r .cell-code}\nlm_3 <- lm(purchase_amount ~ chatbot * mobile_device, abtest_data_mod)\nsummary(lm_3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot * mobile_device, data = abtest_data_mod)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#> -16.98 -14.54  -9.95  14.13  65.24 \n#> \n#> Coefficients:\n#>                       Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)            16.9797     1.0152  16.725   <2e-16 ***\n#> chatbot                -7.0301     1.4284  -4.922    1e-06 ***\n#> mobile_device          -0.8727     1.7987  -0.485    0.628    \n#> chatbot:mobile_device  -0.1526     2.5369  -0.060    0.952    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.66 on 996 degrees of freedom\n#> Multiple R-squared:  0.03534,\tAdjusted R-squared:  0.03244 \n#> F-statistic: 12.16 on 3 and 996 DF,  p-value: 8.034e-08\n```\n:::\n:::\n\nThe calculated CATE for the subgroup mobile_device is -0.1526, but it is statistically not significant.\n\n\n\n# Assignment 4\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-6_761dc6325eb853bee0af114b470918f4'}\n\n```{.r .cell-code}\nlm_4<-glm(purchase~chatbot, family=binomial(link='logit'), data=abtest_data_mod)\nsummary(lm_4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> glm(formula = purchase ~ chatbot, family = binomial(link = \"logit\"), \n#>     data = abtest_data_mod)\n#> \n#> Coefficients:\n#>             Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept) -0.01613    0.08981  -0.180    0.857    \n#> chatbot     -0.98939    0.13484  -7.337 2.18e-13 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 1329.1  on 999  degrees of freedom\n#> Residual deviance: 1273.3  on 998  degrees of freedom\n#> AIC: 1277.3\n#> \n#> Number of Fisher Scoring iterations: 4\n```\n:::\n\n```{.r .cell-code}\nlog_coefficient_chatbot<-lm_4[[\"coefficients\"]][[\"chatbot\"]]\nodds_ratio_chatbot<-exp(log_coefficient_chatbot)\nAnswer4<-c(\"The chatbot reduces the chance of a website visitor actually purchasing by \",round((1-odds_ratio_chatbot)*100,1),\"%. It seems that the chatbot annoys the customers.\")\nAnswer4<-paste(Answer4,collapse=\"\")\nAnswer4\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"The chatbot reduces the chance of a website visitor actually purchasing by 62.8%. It seems that the chatbot annoys the customers.\"\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
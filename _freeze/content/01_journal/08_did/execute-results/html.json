{
  "hash": "9094773f7caed19324c566dbe412cb8e",
  "result": {
    "markdown": "---\ntitle: \"Difference-in-Differences\"\n---\n\n\n# Load packages\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-1_c9a9b843b77e6d5f40dd9f504ba87b68'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(dagitty)\nlibrary(ggdag)\nlibrary(MatchIt)\n```\n:::\n\n\n# Load data\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-2_a31106d17852711f14e3f575dbaff676'}\n\n```{.r .cell-code}\nsetwd(\"D:/CausalDataScience/cdsba-LukasB2324/content/01_journal\")\nhospital_data<-readRDS(\"Data/hospdd.rds\")\n```\n:::\n\n\n\n\n# Assignment 1\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-3_3ea79c82ca2e19e83a938e4ccf296e55'}\n\n```{.r .cell-code}\nhospital_data_zoom_in  <- hospital_data %>% filter(month %in% 3:4)\n\nbefore_control <- hospital_data_zoom_in %>%\n  filter(hospital %in% 19:46, month == 3) %>% \n  pull(satis)\nbefore_treatment <- hospital_data_zoom_in %>%\n  filter(hospital %in% 1:18, month == 3) %>% \n  pull(satis)\nmean_before_control <- mean(before_control)\nmean_before_treatment <- mean(before_treatment)\ndiff_before <- mean_before_treatment - mean_before_control\n\nafter_control <- hospital_data_zoom_in %>%\n  filter(hospital %in% 19:46, month == 4) %>% \n  pull(satis)\nafter_treatment <- hospital_data_zoom_in %>%\n  filter(hospital %in% 1:18, month == 4) %>% \n  pull(satis)\nmean_after_control <- mean(after_control)\nmean_after_treatment <- mean(after_treatment)\n\ndifffter <- mean_after_treatment - mean_after_control\n\ndiff_diff <- difffter - diff_before\nsprintf(\"Estimate of the mean satisfaction for treated hospitals before the treatment: %.2f; Estimate of the mean satisfaction for control hospitals before the treatment: %.2f; Estimate of the mean satisfaction for treated hospitals after the treatment: %.2f; Estimate of the mean satisfaction for control hospitals after the treatment: %.2f; Estimate of the difference-in-differences: %.2f\", mean_before_treatment, mean_before_control, mean_after_treatment, mean_after_control, diff_diff)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"Estimate of the mean satisfaction for treated hospitals before the treatment: 3.53; Estimate of the mean satisfaction for control hospitals before the treatment: 3.42; Estimate of the mean satisfaction for treated hospitals after the treatment: 4.34; Estimate of the mean satisfaction for control hospitals after the treatment: 3.40; Estimate of the difference-in-differences: 0.82\"\n```\n:::\n:::\n\n\n\n\n# Assignment 2\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-4_7301f25d08e0a727cc1e8a69965aae6f'}\n\n```{.r .cell-code}\nlm_hospitals<-lm(satis ~ as.factor(hospital)+frequency+as.factor(month)+procedure, data = hospital_data)\nsummary(lm_hospitals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satis ~ as.factor(hospital) + frequency + as.factor(month) + \n#>     procedure, data = hospital_data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.2699 -0.4604  0.0047  0.4574  4.2569 \n#> \n#> Coefficients:\n#>                        Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)            3.054807   0.058337  52.365  < 2e-16 ***\n#> as.factor(hospital)2   0.369283   0.077169   4.785 1.74e-06 ***\n#> as.factor(hospital)3   0.531657   0.079065   6.724 1.90e-11 ***\n#> as.factor(hospital)4   0.239008   0.073704   3.243  0.00119 ** \n#> as.factor(hospital)5  -0.187606   0.073920  -2.538  0.01117 *  \n#> as.factor(hospital)6   0.422811   0.073769   5.732 1.03e-08 ***\n#> as.factor(hospital)7   1.395230   0.071221  19.590  < 2e-16 ***\n#> as.factor(hospital)8   0.073894   0.076056   0.972  0.33130    \n#> as.factor(hospital)9  -1.541417   0.078040 -19.752  < 2e-16 ***\n#> as.factor(hospital)10  1.666597   0.077009  21.642  < 2e-16 ***\n#> as.factor(hospital)11  0.205881   0.076085   2.706  0.00683 ** \n#> as.factor(hospital)12 -0.088643   0.077981  -1.137  0.25569    \n#> as.factor(hospital)13  0.474560   0.075263   6.305 3.04e-10 ***\n#> as.factor(hospital)14  0.216930   0.079097   2.743  0.00611 ** \n#> as.factor(hospital)15 -0.180409   0.079223  -2.277  0.02280 *  \n#> as.factor(hospital)16  1.413378   0.076976  18.361  < 2e-16 ***\n#> as.factor(hospital)17  0.394071   0.080363   4.904 9.61e-07 ***\n#> as.factor(hospital)18  0.152851   0.093493   1.635  0.10211    \n#> as.factor(hospital)19 -0.747270   0.080883  -9.239  < 2e-16 ***\n#> as.factor(hospital)20  0.051616   0.078844   0.655  0.51270    \n#> as.factor(hospital)21  1.184714   0.083346  14.214  < 2e-16 ***\n#> as.factor(hospital)22  0.751926   0.082314   9.135  < 2e-16 ***\n#> as.factor(hospital)23  0.671462   0.080992   8.290  < 2e-16 ***\n#> as.factor(hospital)24 -0.341779   0.086468  -3.953 7.80e-05 ***\n#> as.factor(hospital)25  0.606550   0.092573   6.552 6.06e-11 ***\n#> as.factor(hospital)26  0.192880   0.078897   2.445  0.01452 *  \n#> as.factor(hospital)27 -0.407223   0.076356  -5.333 9.94e-08 ***\n#> as.factor(hospital)28  0.673916   0.083503   8.071 8.12e-16 ***\n#> as.factor(hospital)29  0.193398   0.080185   2.412  0.01589 *  \n#> as.factor(hospital)30 -0.173233   0.095038  -1.823  0.06838 .  \n#> as.factor(hospital)31  0.488159   0.078912   6.186 6.50e-10 ***\n#> as.factor(hospital)32 -0.343561   0.079867  -4.302 1.72e-05 ***\n#> as.factor(hospital)33 -0.480461   0.078927  -6.087 1.21e-09 ***\n#> as.factor(hospital)34  0.004954   0.074352   0.067  0.94688    \n#> as.factor(hospital)35  0.354500   0.076347   4.643 3.49e-06 ***\n#> as.factor(hospital)36  2.124121   0.077139  27.536  < 2e-16 ***\n#> as.factor(hospital)37  0.122876   0.092438   1.329  0.18380    \n#> as.factor(hospital)38 -0.077458   0.077954  -0.994  0.32043    \n#> as.factor(hospital)39 -0.041024   0.082086  -0.500  0.61725    \n#> as.factor(hospital)40  1.106449   0.077972  14.190  < 2e-16 ***\n#> as.factor(hospital)41 -0.171741   0.076408  -2.248  0.02463 *  \n#> as.factor(hospital)42  0.856891   0.084825  10.102  < 2e-16 ***\n#> as.factor(hospital)43 -0.782887   0.080896  -9.678  < 2e-16 ***\n#> as.factor(hospital)44 -0.014125   0.090375  -0.156  0.87580    \n#> as.factor(hospital)45 -0.217839   0.076349  -2.853  0.00434 ** \n#> as.factor(hospital)46  0.066936   0.082066   0.816  0.41473    \n#> frequency              0.053751   0.007477   7.189 7.19e-13 ***\n#> as.factor(month)2     -0.009608   0.029111  -0.330  0.74138    \n#> as.factor(month)3      0.021969   0.029111   0.755  0.45049    \n#> as.factor(month)4     -0.003284   0.032382  -0.101  0.91923    \n#> as.factor(month)5     -0.009403   0.032382  -0.290  0.77154    \n#> as.factor(month)6     -0.003838   0.032382  -0.119  0.90567    \n#> as.factor(month)7     -0.011194   0.032382  -0.346  0.72958    \n#> procedure              0.847988   0.034101  24.867  < 2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.7213 on 7314 degrees of freedom\n#> Multiple R-squared:  0.5365,\tAdjusted R-squared:  0.5332 \n#> F-statistic: 159.8 on 53 and 7314 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsprintf(\"The estaimate for the average treatment effect is %.2f. It is demanded to include a regressor for each hospital and a regressor for each month. This can be done by 'as.factor(hospital)' and 'as.factor(month)'. Without the command 'as.factor' there would be a regressor 'hospital' and a regressor 'month', but there would not be a regressor for each month and each hospital.\", lm_hospitals[[\"coefficients\"]][[\"procedure\"]])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"The estaimate for the average treatment effect is 0.85. It is demanded to include a regressor for each hospital and a regressor for each month. This can be done by 'as.factor(hospital)' and 'as.factor(month)'. Without the command 'as.factor' there would be a regressor 'hospital' and a regressor 'month', but there would not be a regressor for each month and each hospital.\"\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}